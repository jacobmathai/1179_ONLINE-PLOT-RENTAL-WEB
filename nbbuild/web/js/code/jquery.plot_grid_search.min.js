/* 
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

$(document).ready(function(){
    loadDefault();
});

$('#all').click(function(){
    loadDefault();
});

function loadDefault(){
    var jsonArray = loadDefaultSettings();
    var searchHtml =   '<div class="row masonryRow">';
    console.log(jsonArray.length);
    if(jsonArray.length > 0){
        for(var obj in jsonArray){
            if(jsonArray[obj].contract_type == "For_Sale"){
                searchHtml = searchHtml  + '<div class="col-lg-3 col-md-3 col-sm-6 sale">';
            } else {
                searchHtml = searchHtml  + '<div class="col-lg-3 col-md-3 col-sm-6 rent">';
            }
            searchHtml = searchHtml   +'<div class="propertyItem">'
            +' <div class="propertyContent">'
            +'<a class="propertyType" href="#">'+jsonArray[obj].prop_type+'</a>'
            +' <a href="admin_view_plot.jsp?prop_id='+jsonArray[obj].prop_id+'" class="propertyImgLink">'
            +'<img class="propertyImg" src="SEARCH/photo_01_'+jsonArray[obj].prop_id+'.jpg" alt="" /></a>'
            +' <h4><a href="admin_view_plot.jsp?prop_id='+jsonArray[obj].prop_id+'">'+jsonArray[obj].prop_title+'</a></h4>'
            +'<p>'+jsonArray[obj].address +'</p>'
            +' <div class="divider thin"></div>'
            +' <p class="forSale">'+jsonArray[obj].contract_type+'</p>'
            +' <p class="price">'+jsonArray[obj].price+'</p>'
            +'  </div>'
            +'  <table border="1" class="propertyDetails">'
            +' <tr>'
            +' <td><img src="images/icon-area.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].area+'m</td>'
            //            +' <td><img src="images/icon-bed.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].bedrooms+'</td>'
            //            +'  <td><img src="images/icon-drop.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].bathrooms+'</td>'
            +' </tr>'
            +' </table> '
            +'</div></div><!-- end row -->';
                 
        }
  
    } else {
        searchHtml = searchHtml  +'<div class="col-lg-3 col-md-3 col-sm-6">'
        +'<div class="propertyItem">'
        +'<div class="propertyContent">'
        +'<p>Sorry!     Your search result is not found.<p>'
        +'</div></div>';
    }
    searchHtml = searchHtml +'</div><!-- end row -->';

    $('#gridContainer').show().html(searchHtml);
}

$('#sale').click(function(){
    var propType =  $('#propertyType').val();
    var city =  'Any';
    var downPrice =  'Any';
    var maxPrice =  'Any';
    var area =  'Any';
 
   
    //alert(downPrice + " " + maxPrice + " city: " + city + " pro: " + propType + " Bed: " + beds + " Baths: " + baths + " Area: " + area);
    var param = '?propType='+propType+'&city='+city+'&downPrice='
    +downPrice+'&maxPrice='+maxPrice+'&area='+area;
    var output =  dhtmlxAjax.getSync("PlotSaleServlet"+param);
    var data =  output.xmlDoc.responseText;
    
    var searchHtml =   '<div class="row masonryRow">';
    var jsonArray = JSON.parse(data);
    console.log(jsonArray.length);
    if(jsonArray.length > 0){
        for(var obj in jsonArray){
            searchHtml = searchHtml   +'<div class="propertyItem">'
            +' <div class="propertyContent">'
            +'<a class="propertyType" href="#">'+jsonArray[obj].prop_type+'</a>'
            +' <a href="admin_view_plot.jsp?prop_id='+jsonArray[obj].prop_id+'" class="propertyImgLink">'
            +'<img class="propertyImg" src="SEARCH/photo_01_'+jsonArray[obj].prop_id+'.jpg" alt="" /></a>'
            +' <h4><a href="admin_view_plot.jsp?prop_id='+jsonArray[obj].prop_id+'">'+jsonArray[obj].prop_title+'</a></h4>'
            +'<p>'+jsonArray[obj].address +'</p>'
            +' <div class="divider thin"></div>'
            +' <p class="forSale">'+jsonArray[obj].contract_type+'</p>'
            +' <p class="price">'+jsonArray[obj].price+'</p>'
            +'  </div>'
            +'  <table border="1" class="propertyDetails">'
            +' <tr>'
            +' <td><img src="images/icon-area.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].area+'m</td>'
            //            +' <td><img src="images/icon-bed.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].bedrooms+'</td>'
            //            +'  <td><img src="images/icon-drop.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].bathrooms+'</td>'
            +' </tr>'
            +' </table> '
            +'</div></div><!-- end row -->';
        }
  
    }else {
        searchHtml = searchHtml  +'<div class="col-lg-3 col-md-3 col-sm-6">'
        +'<div class="propertyItem">'
        +'<div class="propertyContent">'
        +'<p>Sorry!     Your search result is not found.<p>'
        +'</div></div>';
    }
    searchHtml = searchHtml +'</div><!-- end row -->';
    $('#gridContainer').show().html(searchHtml);
});

$('#rent').click(function(){
    var propType =  $('#propertyType').val();
    var city =  'Any';
    var downPrice =  'Any';
    var maxPrice =  'Any';  
    var area =  'Any';
 
   
    //alert(downPrice + " " + maxPrice + " city: " + city + " pro: " + propType + " Bed: " + beds + " Baths: " + baths + " Area: " + area);
    var param = '?propType='+propType+'&city='+city+'&downPrice='
    +downPrice+'&maxPrice='+maxPrice+'&area='+area;
    var output =  dhtmlxAjax.getSync("PlotRentSearchServlet"+param);
    var data =  output.xmlDoc.responseText;
    
    var searchHtml =   '<div class="row masonryRow">';
    var jsonArray = JSON.parse(data);
    console.log(jsonArray.length);
    if(jsonArray.length > 0){
        for(var obj in jsonArray){
            searchHtml = searchHtml   +'<div class="propertyItem">'
            +' <div class="propertyContent">'
            +'<a class="propertyType" href="#">'+jsonArray[obj].prop_type+'</a>'
            +' <a href="admin_view_plot.jsp?prop_id='+jsonArray[obj].prop_id+'" class="propertyImgLink">'
            +'<img class="propertyImg" src="SEARCH/photo_01_'+jsonArray[obj].prop_id+'.jpg" alt="" /></a>'
            +' <h4><a href="admin_view_plot.jsp?prop_id='+jsonArray[obj].prop_id+'">'+jsonArray[obj].prop_title+'</a></h4>'
            +'<p>'+jsonArray[obj].address +'</p>'
            +' <div class="divider thin"></div>'
            +' <p class="forSale">'+jsonArray[obj].contract_type+'</p>'
            +' <p class="price">'+jsonArray[obj].price+'</p>'
            +'  </div>'
            +'  <table border="1" class="propertyDetails">'
            +' <tr>'
            +' <td><img src="images/icon-area.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].area+'m</td>'
//            +' <td><img src="images/icon-bed.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].bedrooms+'</td>'
//            +'  <td><img src="images/icon-drop.png" alt="" style="margin-right:7px;" />'+jsonArray[obj].bathrooms+'</td>'
            +' </tr>'
            +' </table> '
            +'</div></div><!-- end row -->';
        }
  
    }else {
        searchHtml = searchHtml  +'<div class="col-lg-3 col-md-3 col-sm-6">'
        +'<div class="propertyItem">'
        +'<div class="propertyContent">'
        +'<p>Sorry!     Your search result is not found.<p>'
        +'</div></div>';
    }
    searchHtml = searchHtml +'</div><!-- end row -->';
    $('#gridContainer').show().html(searchHtml);
});



function loadDefaultSettings(){
    var propType =  $('#propertyType').val();
    var city =  'Any';
    var maxPrice = 'Any';
    var downPrice = 'Any';
    var area =  'Any';

    //alert(downPrice + " " + maxPrice + " city: " + city + " pro: " + propType + " Bed: " + beds + " Baths: " + baths + " Area: " + area);
 
    var param = '?propType='+propType+'&city='+city+'&downPrice='
    +downPrice+'&maxPrice='+maxPrice+'&area='+area;
    var output =  dhtmlxAjax.getSync("DefaultPlotServlet"+param);
    var data =  output.xmlDoc.responseText;
    var jsonArray = JSON.parse(data);
    return jsonArray;
}